/**
 * helloWorld - helloWorld Project Generated from HotTowel Angular
 * @authors 
 * @version v0.0.0
 * @link 
 * @license 
 */
function sendError(e,t,o,a){try{jQuery.ajax({type:"POST",url:"/taxisurfr/logging",contentType:"application/json",data:angular.toJson({url:a,message:e,type:"exception",stackTrace:t,cause:o||""})})}catch(n){console.log("Error server-side logging failed"),console.log(n)}}!function(){"use strict";angular.module("app.core",["ngAnimate","ngSanitize","ui.router","ngplus"])}(),angular.module("formApp",["ngAnimate","ui.router","ui.bootstrap","angular-google-gapi","angular-loading-bar","angular-stripe"]).config(["$stateProvider","$urlRouterProvider","stripeProvider",function(e,t,o){e.state("form",{url:"/form",templateUrl:"app/form.html",controller:"formController"}).state("form.transport",{url:"/transport",templateUrl:"app/form-transport.html"}).state("form.route",{url:"/route?route",templateUrl:"app/form.html",controller:"formController"}).state("form.details",{url:"/details",templateUrl:"app/form-details.html"}).state("form.summary",{url:"/summary",templateUrl:"app/form-summary.html"}).state("form.payment",{url:"/payment",templateUrl:"app/form-payment.html"}).state("form.confirmation",{url:"/confirmation",templateUrl:"app/form-confirmation.html"}),t.otherwise(function(e,t){t.search().route;return"/form/transport"})}]).run(["GAuth","$http","GData","$state","$rootScope","$window","$location",function(e,t,o,a,n,r,i){var s={url:i.absUrl()};console.log("url="+s.url),t.post(getBase(r)+"rest/api/session.get",s).then(function(e){Stripe.setPublishableKey(e.data.stripePublishable)})}]).controller("formController",["$scope","GApi","$http","$state","$window","$filter","stripe",function(e,t,o,a,n,r,i){e.bookingPaid=!1,e.active1=!0,e.active2=!1,e.active3=!1,e.active4=!1,e.dateStatus={opened:!1},e.booking={flightNo:"EZ123",email:"info@xyz.com",date:new Date,name:"Peter Hall",landingTime:"12:00 pm",flightNo:"QX23",pax:1,surfboards:0},e.processing=!1,e.asyncStart=null,e.selectedStart=null,e.selectedEnd=null,e.selectedroute=null,e.onSelectStart=function(t,o,a){e.selectedStart=t.name},e.onSelectEnd=function(t,a,r){e.selectedEnd=t.name,e.noroutefound=null;var i={start:e.selectedStart,end:e.selectedEnd};o.post(getBase(n)+"rest/api/route",i).then(function(t){console.log(e.route),200===t.status?(e.route=t,e.route.pickupTypeText="AIRPORT"===e.route.data?"Flight No.":"Hotel",e.route.pickupTimeText="AIRPORT"===e.route.data?"Landing Time.":"Pickup Time"):e.noroutefound="No route found, sorry. Send an email to dispatch@taxisurfr.com and we will arrange one.",e.active2=!1,o.post(getBase(n)+"rest/api/missingroute",i).then(function(e){})})},e.addBooking=function(t){e.booking.dateText=r("date")(e.booking.date,"fullDate"),e.booking.routeId=e.route.data.id,o.post(getBase(n)+"rest/api/booking",e.booking).then(function(t){e.booking=t})},e.charge=function(){return e.processing=!0,e.payment={},e.payment.card={number:"4242424242424242",cvc:"123",exp_month:"08",exp_year:"19"},i.card.createToken(e.payment.card).then(function(t){console.log("token created for card ending in ",t.card.last4);var r=angular.copy(e.payment);return r.card=void 0,r.token=t.id,r.bookingId=e.booking.data.id,o.post(getBase(n)+"rest/api/payment",r).then(function(t){e.bookingPaid=t.data.ok,t.data.ok===!0?(console.log("payment succeeded!"),a.go("form.confirmation")):(console.log("processing error!"),e.paymentError=t.data.error)})})["catch"](function(t){e.processing=!0,t.type&&/^Stripe/.test(t.type)?console.log("Stripe error: ",t.message):console.log("Other error occurred, possibly with your API",t.message)})},e.processForm=function(o,n){if(e.processing=!0,n.error)throw e.paymentError=n.error.message,e.processing=!1,new Error(e.paymentError);e.session={cardToken:n.id,bookingId:e.booking.id},t.execute("taxisurfr","booking.pay",e.session).then(function(t){e.processing=!1,e.booking=t,"PAID"===e.booking.status?(e.bookingPaid=!0,a.go("form.confirmation")):e.paymentError=e.booking.stripeRefusal})},e.onSelect=function(t,o,a){e.route=t,e.booking.route=e.route.id,e.imgSrc=getBase(n)+"imageservice?image="+e.route.image},e.ignoreEnter=function(e){e.preventDefault()},e.addSession=function(){return t.execute("taxisurfr","session.new",{reference:e.reference,route:e.route,start:e.route.start,end:e.route.end}).then(function(t){e.session=t,e.active2=!0})},e.resetRoute=function(){e.route=null},e.addPayment=function(){e.active4=!0},e.today=function(){e.dt=new Date},e.today(),e.clear=function(){e.dt=null},e.toggleMin=function(){e.minDate=e.minDate?null:new Date},e.toggleMin(),e.maxDate=new Date(2020,5,22),e.open=function(t){e.status.opened=!0},e.setDate=function(t,o,a){e.dt=new Date(t,o,a)},e.dateOptions={formatYear:"yy",startingDay:1},e.status={opened:!1};var s=new Date;s.setDate(s.getDate()+1);var l=new Date;l.setDate(s.getDate()+2),e.events=[{date:s,status:"full"},{date:l,status:"partially"}],e.getDayClass=function(t,o){e.booking.dateText=new Date(t).setHours(0,0,0,0)},e.points=[{name:"Colombo Airport",flag:"5/5c/Flag_of_Alabama.svg/45px-Flag_of_Alabama.svg.png"},{name:"Arugam Bay",flag:"e/e6/Flag_of_Alaska.svg/43px-Flag_of_Alaska.svg.png"},{name:"Dambulla",flag:"e/e6/Flag_of_Alaska.svg/43px-Flag_of_Alaska.svg.png"},{name:"Ella",flag:"4/46/Flag_of_Colorado.svg/45px-Flag_of_Colorado.svg.png"},{name:"Galle",flag:"9/96/Flag_of_Connecticut.svg/39px-Flag_of_Connecticut.svg.png"},{name:"Hikkaduwa",flag:"a/aa/Flag_of_Iowa.svg/44px-Flag_of_Iowa.svg.png"},{name:"Kalpitiya",flag:"0/01/Flag_of_Illinois.svg/46px-Flag_of_Illinois.svg.png"},{name:"Kandy",flag:"5/54/Flag_of_Georgia_%28U.S._state%29.svg/46px-Flag_of_Georgia_%28U.S._state%29.svg.png"},{name:"Polunnaruwa",flag:"b/bc/Flag_of_Wyoming.svg/43px-Flag_of_Wyoming.svg.png"},{name:"Mirissa",flag:"e/ef/Flag_of_Hawaii.svg/46px-Flag_of_Hawaii.svg.png"},{name:"Weligama",flag:"a/a4/Flag_of_Idaho.svg/38px-Flag_of_Idaho.svg.png"}]}]).controller("PaymentCtrl",["$scope",function(e){e.handleStripe=function(e,t){t.error?console.log("error:"+t):(token=t.id,console.log("success:"+token))}}]).directive("focus",["$timeout",function(e){return{scope:{trigger:"@focus"},link:function(t,o){t.$watch("trigger",function(t){"true"===t&&e(function(){o[0].focus()})})}}}]).directive("focusOn",["$timeout",function(e){return function(e,t,o){e.$on(o.focusOn,function(e){t[0].focus()})}}]);var getBase=function(e){return console.log(e.location.hostname),console.log(e.location.port),"localhost"===e.location.hostname?"http://localhost:8080/taxisurfr-1.0/":"https://taxisurfr-taxisurfr.rhcloud.com/"};